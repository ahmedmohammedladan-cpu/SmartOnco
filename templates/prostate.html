<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SmartOnco â€” Prostate Cancer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-primary shadow-sm">
  <div class="container">
    <a class="navbar-brand fw-bold" href="/">SmartOnco</a>
    <div class="d-flex">
      <a href="/selftest_pc" class="btn btn-outline-light me-2">Prostate Cancer Self-Test</a>
      <a href="/clustering_pc" class="btn btn-light">Prostate Cancer Clustering</a>
    </div>
  </div>
</nav>

<!-- Main Content -->
<div class="container my-5">
  <div class="card shadow-lg border-0">
    <div class="card-body p-5">
      <h2 class="text-primary mb-4">ðŸ§¬ SmartOnco â€” Prostate Cancer</h2>
      <p class="text-muted">Enter the patient's medical values to predict prostate cancer risk level.</p>
      
      <!-- Gender Warning -->
      <div class="alert alert-info mb-4">
        <strong>Note:</strong> Prostate cancer screening is only applicable to male patients.
      </div>

      {% if prediction_text %}
        {% if "Low" in prediction_text %}
          <div class="alert alert-success fs-5">{{ prediction_text }}</div>
        {% elif "Moderate" in prediction_text %}
          <div class="alert alert-warning fs-5">{{ prediction_text }}</div>
        {% elif "High" in prediction_text %}
          <div class="alert alert-danger fs-5">{{ prediction_text }}</div>
        {% else %}
          <div class="alert alert-info fs-5">{{ prediction_text }}</div>
        {% endif %}
      {% endif %}

      <!-- âœ… ADD GEMINI EXPLANATION HERE -->
      {% if gemini_explanation %}
        <div class="alert alert-secondary fs-6 mt-3">
          <strong>Gemini AI Explanation:</strong>
          <p>{{ gemini_explanation }}</p>
        </div>
      {% endif %}

      <!-- Prediction Form -->
      <form method="POST" action="/predict_prostate">
        <div class="row">
          <!-- Age -->
          <div class="col-md-6 mb-3">
            <label class="form-label fw-semibold">Age</label>
            <input type="number" class="form-control" name="feature_prostate1" min="40" max="100" required>
            <small class="text-muted">Patient age in years (typically 40+)</small>
          </div>

          <!-- PSA Level -->
          <div class="col-md-6 mb-3">
            <label class="form-label fw-semibold">PSA_Level</label>
            <input type="number" step="0.1" class="form-control" name="feature_prostate2" min="0" max="100" required>
            <small class="text-muted">Prostate-Specific Antigen level (ng/mL) - Normal: 0-4 ng/mL</small>
          </div>

          <!-- Biopsy Result -->
          <div class="col-md-6 mb-3">
            <label class="form-label fw-semibold">Biopsy_Result</label>
            <select class="form-control" name="feature_prostate3" required>
              <option value="">Select...</option>
              <option value="0">Negative (No cancer)</option>
              <option value="1">Positive (Cancer found)</option>
            </select>
            <small class="text-muted">0 = Negative, 1 = Positive</small>
          </div>

          <!-- Tumor Size -->
          <div class="col-md-6 mb-3">
            <label class="form-label fw-semibold">Tumor_Size</label>
            <input type="number" step="0.1" class="form-control" name="feature_prostate4" min="0" max="50" required>
            <small class="text-muted">Tumor size in centimeters (cm)</small>
          </div>

          <!-- Cancer Stage -->
          <div class="col-md-6 mb-3">
            <label class="form-label fw-semibold">Cancer_Stage</label>
            <select class="form-control" name="feature_prostate5" required>
              <option value="">Select Stage</option>
              <option value="1">Stage I (Localized)</option>
              <option value="2">Stage II (Early advanced)</option>
              <option value="3">Stage III (Advanced)</option>
              <option value="4">Stage IV (Metastatic)</option>
            </select>
            <small class="text-muted">1-4 (I-IV cancer staging)</small>
          </div>

          <!-- Blood Pressure -->
          <div class="col-md-6 mb-3">
            <label class="form-label fw-semibold">Blood_Pressure</label>
            <input type="number" class="form-control" name="feature_prostate6" min="60" max="200" required>
            <small class="text-muted">Systolic blood pressure (mmHg)</small>
          </div>

          <!-- Cholesterol Level -->
          <div class="col-md-6 mb-3">
            <label class="form-label fw-semibold">Cholesterol_Level</label>
            <input type="number" class="form-control" name="feature_prostate7" min="100" max="300" required>
            <small class="text-muted">Total cholesterol level (mg/dL)</small>
          </div>

          <!-- Family History -->
          <div class="col-md-6 mb-3">
            <label class="form-label fw-semibold">Family_History</label>
            <select class="form-control" name="feature_prostate8" required>
              <option value="">Select...</option>
              <option value="0">No family history</option>
              <option value="1">Family history present</option>
            </select>
            <small class="text-muted">0 = No, 1 = Yes</small>
          </div>

          <!-- Smoking History -->
          <div class="col-md-6 mb-3">
            <label class="form-label fw-semibold">Smoking_History</label>
            <select class="form-control" name="feature_prostate9" required>
              <option value="">Select...</option>
              <option value="0">Non-smoker</option>
              <option value="1">Current/Former smoker</option>
            </select>
            <small class="text-muted">0 = No, 1 = Yes</small>
          </div>

          <!-- Alcohol Consumption -->
          <div class="col-md-6 mb-3">
            <label class="form-label fw-semibold">Alcohol_Consumption</label>
            <select class="form-control" name="feature_prostate10" required>
              <option value="">Select...</option>
              <option value="0">Non-drinker</option>
              <option value="1">Moderate/Heavy drinker</option>
            </select>
            <small class="text-muted">0 = No, 1 = Yes</small>
          </div>

          <!-- Back Pain -->
          <div class="col-md-6 mb-3">
            <label class="form-label fw-semibold">Back_Pain</label>
            <select class="form-control" name="feature_prostate11" required>
              <option value="">Select...</option>
              <option value="0">No back pain</option>
              <option value="1">Experiences back pain</option>
            </select>
            <small class="text-muted">0 = No, 1 = Yes</small>
          </div>

          <!-- Fatigue Level -->
          <div class="col-md-6 mb-3">
            <label class="form-label fw-semibold">Fatigue_Level</label>
            <select class="form-control" name="feature_prostate12" required>
              <option value="">Select...</option>
              <option value="0">No fatigue</option>
              <option value="1">Experiences fatigue</option>
            </select>
            <small class="text-muted">0 = No, 1 = Yes</small>
          </div>
        </div>

        <div class="d-flex justify-content-between mt-4">
          <button type="button" class="btn btn-outline-secondary" onclick="loadDemoProstate()">
            Load Demo Patient
          </button>
          <button type="submit" class="btn btn-success px-4">Predict</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Footer -->
<footer class="bg-primary text-white text-center py-3 mt-5">
  <small>&copy; 2025 SmartOnco</small>
</footer>

<!-- Script -->
<script>
  function loadDemoProstate() {
    // High Risk Demo Patient
    const demoValues = [
      65,    // Age
      8.5,   // PSA Level (high)
      1,     // Biopsy Result (positive)
      2.5,   // Tumor Size (cm)
      3,     // Cancer Stage (III)
      145,   // Blood Pressure
      240,   // Cholesterol Level
      1,     // Family History (yes)
      1,     // Smoking History (yes)
      1,     // Alcohol Consumption (yes)
      1,     // Back Pain (yes)
      1      // Fatigue Level (yes)
    ];

    // Fill all inputs
    for (let i = 1; i <= 12; i++) {
      const input = document.querySelector(`input[name="feature_prostate${i}"]`);
      const select = document.querySelector(`select[name="feature_prostate${i}"]`);
      
      if (input) {
        input.value = demoValues[i-1];
      } else if (select) {
        select.value = demoValues[i-1];
      }
    }
    
    alert("Demo patient values (High Risk Male) filled.");
  }
</script>

</body>
</html>
